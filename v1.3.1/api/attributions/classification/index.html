
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../../assets/x_logo.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>Classification - Xplique</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../css/custom.css">
    
    
      
  



  
  



  <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-132343476-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="dark" data-md-color-accent="indigo">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#classification-explanations-with-xplique" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Xplique" class="md-header__button md-logo" aria-label="Xplique" data-md-component="logo">
      
  <img src="../../../assets/x_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Xplique
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Classification
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="dark" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/deel-ai/xplique/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    deel-ai/xplique
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Xplique" class="md-nav__button md-logo" aria-label="Xplique" data-md-component="logo">
      
  <img src="../../../assets/x_logo.png" alt="logo">

    </a>
    Xplique
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/deel-ai/xplique/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    deel-ai/xplique
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Attributions methods
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Attributions methods" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Attributions methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../api_attributions/" class="md-nav__link">
        API Description
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      <label class="md-nav__link" for="__nav_2_2">
        Methods
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Methods" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/deconvnet/" class="md-nav__link">
        DeconvNet
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/forgrad/" class="md-nav__link">
        ForGRad
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/grad_cam/" class="md-nav__link">
        Grad-CAM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/grad_cam_pp/" class="md-nav__link">
        Grad-CAM++
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/gradient_input/" class="md-nav__link">
        Gradient Input
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/guided_backpropagation/" class="md-nav__link">
        Guided Backprop
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/hsic/" class="md-nav__link">
        Hsic Attribution Method
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/integrated_gradients/" class="md-nav__link">
        Integrated Gradient
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/kernel_shap/" class="md-nav__link">
        KernelSHAP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/lime/" class="md-nav__link">
        Lime
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/occlusion/" class="md-nav__link">
        Occlusion sensitivity
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/rise/" class="md-nav__link">
        Rise
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/saliency/" class="md-nav__link">
        Saliency
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/smoothgrad/" class="md-nav__link">
        SmoothGrad
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/sobol/" class="md-nav__link">
        Sobol Attribution Method
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/square_grad/" class="md-nav__link">
        SquareGrad
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../methods/vargrad/" class="md-nav__link">
        VarGrad
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      <label class="md-nav__link" for="__nav_2_3">
        Metrics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Metrics" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Metrics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/api_metrics/" class="md-nav__link">
        API Description
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/deletion/" class="md-nav__link">
        Deletion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/insertion/" class="md-nav__link">
        Insertion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/mu_fidelity/" class="md-nav__link">
        MuFidelity
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/avg_stability/" class="md-nav__link">
        AverageStability
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/" class="md-nav__link">
        PyTorch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../callable/" class="md-nav__link">
        Callable
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Classification
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Classification
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#which-kind-of-tasks-are-supported-by-xplique" class="md-nav__link">
    Which kind of tasks are supported by Xplique?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-example" class="md-nav__link">
    Simple example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use-it" class="md-nav__link">
    How to use it?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-operator" class="md-nav__link">
    The operator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models-output" class="md-nav__link">
    Model's output
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-targets-parameter" class="md-nav__link">
    The targets parameter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-can-be-explained-with-it" class="md-nav__link">
    What can be explained with it?
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../object_detection/" class="md-nav__link">
        Object Detection
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../regression/" class="md-nav__link">
        Regression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../semantic_segmentation/" class="md-nav__link">
        Semantic Segmentation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Concept based
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Concept based" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Concept based
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/cav/" class="md-nav__link">
        Cav
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/tcav/" class="md-nav__link">
        Tcav
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/craft/" class="md-nav__link">
        Craft
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Feature visualization
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Feature visualization" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Feature visualization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../feature_viz/maco/" class="md-nav__link">
        Modern Feature Visualization (MaCo)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../feature_viz/feature_viz/" class="md-nav__link">
        Feature visualization
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#which-kind-of-tasks-are-supported-by-xplique" class="md-nav__link">
    Which kind of tasks are supported by Xplique?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-example" class="md-nav__link">
    Simple example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use-it" class="md-nav__link">
    How to use it?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-operator" class="md-nav__link">
    The operator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models-output" class="md-nav__link">
    Model's output
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-targets-parameter" class="md-nav__link">
    The targets parameter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-can-be-explained-with-it" class="md-nav__link">
    What can be explained with it?
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/deel-ai/xplique/edit/master/docs/api/attributions/classification.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="classification-explanations-with-xplique">Classification explanations with Xplique<a class="headerlink" href="#classification-explanations-with-xplique" title="Permanent link">&para;</a></h1>
<p><a href="https://colab.research.google.com/drive/1XproaVxXjO9nrBSyyy7BuKJ1vy21iHs2">Attributions: Getting started tutorial</a> <sub> <a href="https://colab.research.google.com/drive/1XproaVxXjO9nrBSyyy7BuKJ1vy21iHs2"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a> </sub></p>
<h2 id="which-kind-of-tasks-are-supported-by-xplique">Which kind of tasks are supported by Xplique?<a class="headerlink" href="#which-kind-of-tasks-are-supported-by-xplique" title="Permanent link">&para;</a></h2>
<p>With the <a href="../api/attributions/operator">operator's api</a> you can treat many different problems with Xplique. There is one operator for each task.</p>
<table>
<thead>
<tr>
<th align="left">Task and Documentation link</th>
<th align="left"><code>operator</code> parameter value <br/> from <code>xplique.Tasks</code> Enum</th>
<th align="left">Tutorial link</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>Classification</strong></td>
<td align="left"><code>CLASSIFICATION</code></td>
<td align="left"><sub> <a href="https://colab.research.google.com/drive/1XproaVxXjO9nrBSyyy7BuKJ1vy21iHs2"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a> </sub></td>
</tr>
<tr>
<td align="left"><a href="../object_detection/">Object Detection</a></td>
<td align="left"><code>OBJECT_DETECTION</code></td>
<td align="left"><sub> <a href="https://colab.research.google.com/drive/1X3Yq7BduMKqTA0XEheoVIpOo3IvOrzWL"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a> </sub></td>
</tr>
<tr>
<td align="left"><a href="../regression/">Regression</a></td>
<td align="left"><code>REGRESSION</code></td>
<td align="left"><sub> <a href="https://colab.research.google.com/drive/1pjDJmAa9oeSquYtbYh6tksU6eTmObIcq"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a> </sub></td>
</tr>
<tr>
<td align="left"><a href="../semantic_segmentation/">Semantic Segmentation</a></td>
<td align="left"><code>SEMANTIC_SEGMENTATION</code></td>
<td align="left"><sub> <a href="https://colab.research.google.com/drive/1AHg7KO1fCOX5nZLGZfxkZ2-DLPPdSfbX"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a> </sub></td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>They all share the <a href="../api_attributions/">API for Xplique attribution methods</a>.</p>
</div>
<h2 id="simple-example">Simple example<a class="headerlink" href="#simple-example" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">xplique</span>
<span class="kn">from</span> <span class="nn">xplique.attributions</span> <span class="kn">import</span> <span class="n">Saliency</span>
<span class="kn">from</span> <span class="nn">xplique.metrics</span> <span class="kn">import</span> <span class="n">Deletion</span>

<span class="c1"># load inputs and model</span>
<span class="c1"># ...</span>

<span class="c1"># for classification it is recommended to remove softmax layer if there is one</span>
<span class="c1"># model.layers[-1].activation = tf.keras.activations.linear</span>

<span class="c1"># for classification, `targets` are the one hot encoding of the predicted class</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span> <span class="n">depth</span><span class="o">=</span><span class="n">nb_classes</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># compute explanations by specifying the classification operator</span>
<span class="n">explainer</span> <span class="o">=</span> <span class="n">Saliency</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">operator</span><span class="o">=</span><span class="n">xplique</span><span class="o">.</span><span class="n">Tasks</span><span class="o">.</span><span class="n">CLASSIFICATION</span><span class="p">)</span>
<span class="n">explanations</span> <span class="o">=</span> <span class="n">explainer</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>

<span class="c1"># compute metrics on those explanations</span>
<span class="c1"># if the softmax was removed,</span>
<span class="c1"># it is possible to specify it to obtain more interpretable metrics</span>
<span class="n">metric</span> <span class="o">=</span> <span class="n">Deletion</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span>
                  <span class="n">operator</span><span class="o">=</span><span class="n">xplique</span><span class="o">.</span><span class="n">Tasks</span><span class="o">.</span><span class="n">CLASSIFICATION</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)</span>
<span class="n">score_saliency</span> <span class="o">=</span> <span class="n">metric</span><span class="p">(</span><span class="n">explanations</span><span class="p">)</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In general, if you are doing classification tasks, it is better to not include the final softmax layer in your model but to work with logits instead!</p>
</div>
<h2 id="how-to-use-it">How to use it?<a class="headerlink" href="#how-to-use-it" title="Permanent link">&para;</a></h2>
<p>To apply attribution methods, the <a href="../api_attributions/"><strong>common API documentation</strong></a> describes the parameters and how to fix them. However, depending on the task and thus on the <code>operator</code>, there are three points that vary:</p>
<ul>
<li>
<p><strong><a href="#the-operator">The <code>operator</code> parameter</a></strong> value, it is an Enum or a string identifying the task,</p>
</li>
<li>
<p><strong><a href="#models-output">The model's output</a></strong> specification, as <code>model(inputs)</code> is used in the computation of the operators, and</p>
</li>
<li>
<p><strong><a href="#the-targets-parameter">The <code>targets</code> parameter</a></strong> format, indeed, the <code>targets</code> parameter specifies what to explain and the format of such specification depends on the task.</p>
</li>
</ul>
<h2 id="the-operator">The <code>operator</code><a class="headerlink" href="#the-operator" title="Permanent link">&para;</a></h2>
<h3 id="how-to-specify-it">How to specify it<a class="headerlink" href="#how-to-specify-it" title="Permanent link">&para;</a></h3>
<p>In Xplique, to adapt attribution methods, you should specify the task to the <code>operator</code> parameter. In the case of classification, with either:
<div class="highlight"><pre><span></span><code><span class="n">Method</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">Method</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">operator</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">Method</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">operator</span><span class="o">=</span><span class="n">xplique</span><span class="o">.</span><span class="n">Tasks</span><span class="o">.</span><span class="n">CLASSIFICATION</span><span class="p">)</span>
</code></pre></div></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Classification if the default behavior of Xplique attribution methods, hence there is no need to specify it. Nonetheless, it is recommended to still do so to ensure a good comprehension of what is explained.</p>
</div>
<h3 id="the-computation">The computation<a class="headerlink" href="#the-computation" title="Permanent link">&para;</a></h3>
<p>The classification operator multiplies model's predictions on <code>inputs</code> with <code>targets</code> and sum it for each input to explain. However, only one value should be non-zero in <code>targets</code>, thus, the classification operator returns the model output for the specified (via <code>targets</code>) class.
<div class="highlight"><pre><span></span><code><span class="n">scores</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="o">*</span> <span class="n">targets</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="the-behavior">The behavior<a class="headerlink" href="#the-behavior" title="Permanent link">&para;</a></h3>
<ul>
<li>In the case of <a href="../api_attributions/#gradient-based-approaches">perturbation-based methods</a>, the perturbation score corresponds to the difference between the initial logits value for the predicted classes and the same logits for predictions over perturbed inputs.</li>
<li>For <a href="../api_attributions/#perturbation-based-approaches">gradient-based methods</a>, the gradient of logits of interest with respect to the inputs.</li>
</ul>
<p>The logits of interest are specified via the <code>targets</code> parameter described in <a href="#the-targets-parameter">the related section</a>.</p>
<h2 id="models-output">Model's output<a class="headerlink" href="#models-output" title="Permanent link">&para;</a></h2>
<p>We expect <code>model(inputs)</code> to yield a <span class="arithmatex">\((n, c)\)</span> tensor or array where <span class="arithmatex">\(n\)</span> is the number of input samples and <span class="arithmatex">\(c\)</span> is the number of classes. </p>
<h2 id="the-targets-parameter">The <code>targets</code> parameter<a class="headerlink" href="#the-targets-parameter" title="Permanent link">&para;</a></h2>
<h3 id="role">Role<a class="headerlink" href="#role" title="Permanent link">&para;</a></h3>
<p>The <code>targets</code> parameter specifies what is to explain in the <code>inputs</code>, it is passed to the <code>explain</code> or to the <code>__call__</code> method of an explainer or metric and used by the operators. In the case of classification, it indicates the class to explain, or specifies <a href="#contrastive-explanations">contrastive explanations</a>.</p>
<h3 id="format">Format<a class="headerlink" href="#format" title="Permanent link">&para;</a></h3>
<p>The <code>targets</code> parameter in the case of classification should have the same shape as the <a href="#models-output">model's output</a> as they are multiplied point-wise. Hence, the shape is <span class="arithmatex">\((n, c)\)</span> with <span class="arithmatex">\(n\)</span> the number of samples to be explained (it should match the first dimension of <code>inputs</code>) and <span class="arithmatex">\(c\)</span> the number of classes. The <code>targets</code> parameter expects values among <span class="arithmatex">\({-1, 0, 1}\)</span> but most values should be <span class="arithmatex">\(0\)</span> and most of the time only one should be <span class="arithmatex">\(1\)</span> for each sample. <span class="arithmatex">\(-1\)</span> are only used for <a href="#contrastive-explanations">contrastive explanations</a>.</p>
<h3 id="in-practice">In practice<a class="headerlink" href="#in-practice" title="Permanent link">&para;</a></h3>
<p>In the <a href="#simple-example">simple example</a>, the <code>targets</code> value provided is computed with <code>tf.one_hot(tf.argmax(model(inputs), axis=-1), axis=-1)</code>. Literally, the one hot encoding of the predicted class, this specifies which class to explain.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is better to explain the predicted class than the expected class as the goal is to explain the model's prediction.</p>
</div>
<h2 id="what-can-be-explained-with-it">What can be explained with it?<a class="headerlink" href="#what-can-be-explained-with-it" title="Permanent link">&para;</a></h2>
<h3 id="explain-the-predicted-class">Explain the predicted class<a class="headerlink" href="#explain-the-predicted-class" title="Permanent link">&para;</a></h3>
<p>By specifying <code>targets</code> with a one hot encoding of the predicted class, the explanation will highlight which features were important for this prediction.</p>
<h3 id="contrastive-explanations">Contrastive explanations<a class="headerlink" href="#contrastive-explanations" title="Permanent link">&para;</a></h3>
<p>By specifying <code>targets</code> with zeros everywhere, <code>1</code> for the first class, and <code>-1</code> for the second class. The explanation will show which features were important to predict the first and and not the second one.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If the model made a mistake, an interesting explanation is predicted class versus expected class.</p>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../callable/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Callable" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Callable
            </div>
          </div>
        </a>
      
      
        
        <a href="../object_detection/" class="md-footer__link md-footer__link--next" aria-label="Next: Object Detection" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Object Detection
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.409db549.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.756773cc.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../js/custom.js"></script>
      
    
  </body>
</html>