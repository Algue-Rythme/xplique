
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../../../assets/x_logo.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>Hsic Attribution Method - Xplique</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../../css/custom.css">
    
    
      
  



  
  



  <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-132343476-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="dark" data-md-color-accent="indigo">
  
    
    <script>function __prefix(e){return new URL("../../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hsic-attribution-method" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Xplique" class="md-header__button md-logo" aria-label="Xplique" data-md-component="logo">
      
  <img src="../../../../assets/x_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Xplique
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Hsic Attribution Method
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="dark" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/deel-ai/xplique/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    deel-ai/xplique
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Xplique" class="md-nav__button md-logo" aria-label="Xplique" data-md-component="logo">
      
  <img src="../../../../assets/x_logo.png" alt="logo">

    </a>
    Xplique
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/deel-ai/xplique/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    deel-ai/xplique
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Attributions methods
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Attributions methods" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Attributions methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../api_attributions/" class="md-nav__link">
        API Description
      </a>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" checked>
      
      <label class="md-nav__link" for="__nav_2_2">
        Methods
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Methods" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../deconvnet/" class="md-nav__link">
        DeconvNet
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../forgrad/" class="md-nav__link">
        ForGRad
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../grad_cam/" class="md-nav__link">
        Grad-CAM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../grad_cam_pp/" class="md-nav__link">
        Grad-CAM++
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gradient_input/" class="md-nav__link">
        Gradient Input
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guided_backpropagation/" class="md-nav__link">
        Guided Backprop
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Hsic Attribution Method
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Hsic Attribution Method
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notebooks" class="md-nav__link">
    Notebooks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#HsicAttributionMethod" class="md-nav__link">
    HsicAttributionMethod
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../integrated_gradients/" class="md-nav__link">
        Integrated Gradient
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kernel_shap/" class="md-nav__link">
        KernelSHAP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../lime/" class="md-nav__link">
        Lime
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../occlusion/" class="md-nav__link">
        Occlusion sensitivity
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rise/" class="md-nav__link">
        Rise
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../saliency/" class="md-nav__link">
        Saliency
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../smoothgrad/" class="md-nav__link">
        SmoothGrad
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sobol/" class="md-nav__link">
        Sobol Attribution Method
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../square_grad/" class="md-nav__link">
        SquareGrad
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../vargrad/" class="md-nav__link">
        VarGrad
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      <label class="md-nav__link" for="__nav_2_3">
        Metrics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Metrics" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Metrics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../metrics/api_metrics/" class="md-nav__link">
        API Description
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../metrics/deletion/" class="md-nav__link">
        Deletion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../metrics/insertion/" class="md-nav__link">
        Insertion
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../metrics/mu_fidelity/" class="md-nav__link">
        MuFidelity
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../metrics/avg_stability/" class="md-nav__link">
        AverageStability
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../pytorch/" class="md-nav__link">
        PyTorch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../callable/" class="md-nav__link">
        Callable
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../classification/" class="md-nav__link">
        Classification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../object_detection/" class="md-nav__link">
        Object Detection
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../regression/" class="md-nav__link">
        Regression
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../semantic_segmentation/" class="md-nav__link">
        Semantic Segmentation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Concept based
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Concept based" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Concept based
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/cav/" class="md-nav__link">
        Cav
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/tcav/" class="md-nav__link">
        Tcav
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/craft/" class="md-nav__link">
        Craft
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Feature visualization
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Feature visualization" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Feature visualization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../feature_viz/maco/" class="md-nav__link">
        Modern Feature Visualization (MaCo)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../feature_viz/feature_viz/" class="md-nav__link">
        Feature visualization
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notebooks" class="md-nav__link">
    Notebooks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#HsicAttributionMethod" class="md-nav__link">
    HsicAttributionMethod
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/deel-ai/xplique/edit/master/docs/api/attributions/methods/hsic.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="hsic-attribution-method">Hsic Attribution Method<a class="headerlink" href="#hsic-attribution-method" title="Permanent link">&para;</a></h1>
<p><sub>
    <img src="https://upload.wikimedia.org/wikipedia/commons/d/d0/Google_Colaboratory_SVG_Logo.svg" width="20">
</sub><a href="https://colab.research.google.com/drive/1XproaVxXjO9nrBSyyy7BuKJ1vy21iHs2">View colab tutorial</a> | 
<sub>
    <img src="https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg" width="20">
</sub><a href="https://github.com/deel-ai/xplique/blob/master/xplique/attributions/global_sensitivity_analysis/hsic_attribution_method.py">View source</a> |
📰 <a href="https://arxiv.org/abs/2206.06219">Paper</a></p>
<p>The Hsic attribution method from Novello, Fel, Vigouroux<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> explains a neural network's prediction for a given input image by assessing the dependence between the output and patches of the input. Thanks to the sample efficiency of HSIC Estimator, this black box method requires fewer forward passes to produce relevant explanations.</p>
<p>Let's consider two random variables which are the perturbation associated with each patch of the input image, <span class="arithmatex">\(X_i, i \in \{1,...d\}\)</span> with <span class="arithmatex">\(d= \text{grid_size}^2\)</span> image patches and the output <span class="arithmatex">\(Y\)</span>. Let <span class="arithmatex">\(X^1_i,...,X^p_i\)</span> and <span class="arithmatex">\(Y^1,...,Y^p\)</span> be <span class="arithmatex">\(p\)</span> samples of <span class="arithmatex">\(X_i\)</span> and <span class="arithmatex">\(Y\)</span>. HSIC attribution method requires selecting a kernel for the input and the output to construct an RKHS on which is computed the Maximum Mean Discrepancy, a dissimilarity metric between distributions. Let <span class="arithmatex">\(k:\mathbb{R}^2 \rightarrow \mathbb{R}\)</span> and <span class="arithmatex">\(l:\mathbb{R}^2 \rightarrow \mathbb{R}\)</span> the kernels selected for <span class="arithmatex">\(X_i\)</span> and <span class="arithmatex">\(Y\)</span>, HSIC is estimated with an error <span class="arithmatex">\(\mathcal{O}(1/\sqrt{p})\)</span> using the estimator 
$$
\mathcal{H}^p_{X_i, Y} = \frac{1}{(p-1)^2} \operatorname{tr} (KHLH),
$$
where <span class="arithmatex">\(H, L, K \in \mathbb{R}^{p \times p}\)</span> and <span class="arithmatex">\(K_{ij} = k(x_i, x_j), L_{i,j} = l(y_i, y_j)\)</span> and <span class="arithmatex">\(H_{ij} = \delta(i=j) - p^{-1}\)</span> where <span class="arithmatex">\(\delta(i=j) = 1\)</span> if <span class="arithmatex">\(i=j\)</span> and <span class="arithmatex">\(0\)</span> otherwise.</p>
<p>In the paper <a href="https://arxiv.org/abs/2206.06219">Making Sense of Dependence: Efficient Black-box Explanations Using Dependence Measure</a>,  the sampler <code>LatinHypercube</code> is used to sample the perturbations. Note however that the present implementation uses <code>TFSobolSequence</code> as default sampler because <code>LatinHypercube</code> requires scipy <span class="arithmatex">\(\geq\)</span> <code>1.7.0</code>. you can nevertheless use this sampler -- which is included in the library -- by specifying it during the init of your explainer. </p>
<p>For the kernel <span class="arithmatex">\(k\)</span> applied on <span class="arithmatex">\(X_i\)</span>, a modified Dirac kernel is used to enable an ANOVA-like decomposition property that allows assessing pairwise patch interactions (see the paper for more details). For the kernel <span class="arithmatex">\(l\)</span> of output <span class="arithmatex">\(Y\)</span>, a Radial Basis Function (RBF) is used.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We recommend using a grid size of <span class="arithmatex">\(7 \times 7\)</span> to define the image patches. The paper uses a number of forwards of <span class="arithmatex">\(1500\)</span> to obtain the most faithful explanations and <span class="arithmatex">\(750\)</span> for a more budget - but still faithful - version.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>To explain small objects in images, it may be necessary to increase the <code>grid_size</code>, which also requires an increase in <code>nb_design</code>. However, increasing both may impact the memory usage and result in out of memory errors, hence, setting <code>estimator_batch_size</code> parameter enables a limited usage of the memory. Note that the classical <code>batch_size</code> correspond to the batch_size used in the model call, here <code>estimator_batch_size</code> is intern to the method estimator.</p>
</div>
<h2 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h2>
<p>Low budget version</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">xplique.attributions</span> <span class="kn">import</span> <span class="n">HsicAttributionMethod</span>

<span class="c1"># load images, labels and model</span>
<span class="c1"># ...</span>

<span class="n">explainer</span> <span class="o">=</span> <span class="n">HsicAttributionMethod</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">nb_design</span><span class="o">=</span><span class="mi">750</span><span class="p">)</span>
<span class="n">explanations</span> <span class="o">=</span> <span class="n">explainer</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</code></pre></div>
<p>High budget version</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">xplique.attributions</span> <span class="kn">import</span> <span class="n">HsicAttributionMethod</span>

<span class="c1"># load images, labels and model</span>
<span class="c1"># ...</span>

<span class="n">explainer</span> <span class="o">=</span> <span class="n">HsicAttributionMethod</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">nb_design</span><span class="o">=</span><span class="mi">1500</span><span class="p">)</span>
<span class="n">explanations</span> <span class="o">=</span> <span class="n">explainer</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</code></pre></div>
<p>Recommended version, (you need scipy <span class="arithmatex">\(\geq\)</span> <code>1.7.0</code>)</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">xplique.attributions</span> <span class="kn">import</span> <span class="n">HsicAttributionMethod</span>
<span class="kn">from</span> <span class="nn">xplique.attributions.global_sensitivity_analysis</span> <span class="kn">import</span> <span class="n">LatinHypercube</span>

<span class="c1"># load images, labels and model</span>
<span class="c1"># ...</span>

<span class="n">explainer</span> <span class="o">=</span> <span class="n">HsicAttributionMethod</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> 
                                  <span class="n">grid_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">nb_design</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span>
                                  <span class="n">sampler</span> <span class="o">=</span> <span class="n">LatinHypercube</span><span class="p">(</span><span class="n">binary</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">explanations</span> <span class="o">=</span> <span class="n">explainer</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</code></pre></div>
<h2 id="notebooks">Notebooks<a class="headerlink" href="#notebooks" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://colab.research.google.com/drive
/1XproaVxXjO9nrBSyyy7BuKJ1vy21iHs2"><strong>Attribution Methods</strong>: Getting started</a> <sub> <a href="https://colab.research.google.com/drive/1XproaVxXjO9nrBSyyy7BuKJ1vy21iHs2"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a> </sub></li>
</ul>
<h2 class="numkdoc" id="HsicAttributionMethod"><code>HsicAttributionMethod</code><a class="headerlink" href="#HsicAttributionMethod" title="Permanent link">&para;</a></h2>
<p>HSIC Attribution Method.
Compute the dependance of each input dimension wrt the output using Hilbert-Schmidt Independance
Criterion, a perturbation function on a grid and an adapted sampling as described in
the original paper.
<br></p>
<h4 class="numkdoc" id="__init__"><code>__init__(<span class='parameter-self'>self</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> grid_size</span>: <span class='parameter-type'> int = 8</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> nb_design</span>: <span class='parameter-type'> int = 500</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> sampler</span>: <span class='parameter-type'> Union[xplique.attributions.global_sensitivity_analysis.samplers.Sampler, None] = None</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> estimator</span>: <span class='parameter-type'> Union[xplique.attributions.global_sensitivity_analysis.hsic_estimators.HsicEstimator, None] = None</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> perturbation_function</span>: <span class='parameter-type'> Union[Callable, str, None] = 'inpainting'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> batch_size</span>: <span class='parameter-type'> int = 256</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> estimator_batch_size</span>: <span class='parameter-type'> int = None</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> operator</span>: <span class='parameter-type'> Union[xplique.commons.operators_operations.Tasks, str</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Callable[[keras.engine.training.Model, tf.Tensor, tf.Tensor], float], None] = None)</code><a class="headerlink" href="#__init__" title="Permanent link">&para;</a></h4>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>model</span></strong>            : <span class='parameter-type'>model</span> </p>
<ul>
<li><p> Model used for computing explanations.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>grid_size</span></strong>            : <span class='parameter-type'>int = 8</span> </p>
<ul>
<li><p> Cut the image in a grid of (grid_size, grid_size) to estimate an indice per cell.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>nb_design</span></strong>            : <span class='parameter-type'>int = 500</span> </p>
<ul>
<li><p> Number of design for the sampler.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>sampler</span></strong>            : <span class='parameter-type'>Union[xplique.attributions.global_sensitivity_analysis.samplers.Sampler, None] = None</span> </p>
<ul>
<li><p> Sampler used to generate the (quasi-)monte carlo samples, LHS or QMC.</p><p> For more option, see the sampler module. Note that the original paper uses LHS but here the default sampler is TFSobolSequence as LHS requires scipy 1.7.0.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>estimator</span></strong>            : <span class='parameter-type'>Union[xplique.attributions.global_sensitivity_analysis.hsic_estimators.HsicEstimator, None] = None</span> </p>
<ul>
<li><p> Estimator used to compute the HSIC score.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>perturbation_function</span></strong>            : <span class='parameter-type'>Union[Callable, str, None] = 'inpainting'</span> </p>
<ul>
<li><p> Function to call to apply the perturbation on the input. Can also be string: 'inpainting', 'blurring', or 'amplitude'.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>batch_size</span></strong>            : <span class='parameter-type'>int = 256</span> </p>
<ul>
<li><p> Batch size to use for the forwards.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>estimator_batch_size</span></strong>            : <span class='parameter-type'>int = None</span> </p>
<ul>
<li><p> Batch size to use in the estimator. It should only be set if HSIC exceeds the memory.</p><p> By default, a tensor of <code>grid_size</code>² * <code>nb_design</code>² is created.</p><p> <code>estimator_batch_size</code> is used over the <code>nb_design</code>² dimension.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>operator</span></strong>            : <span class='parameter-type'>Union[xplique.commons.operators_operations.Tasks, str, Callable[[keras.engine.training.Model, tf.Tensor, tf.Tensor], float], None] = None</span> </p>
<ul>
<li><p> Function g to explain, g take 3 parameters (f, x, y) and should return a scalar, with f the model, x the inputs and y the targets. If None, use the standard operator g(f, x, y) = f(x)[y].</p> </li>
</ul>
</li>
</ul>
<h4 class="numkdoc" id="explain"><code>explain(<span class='parameter-self'>self</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> inputs</span>: <span class='parameter-type'> Union[tf.Dataset, tf.Tensor, numpy.ndarray]</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> targets</span>: <span class='parameter-type'> Union[tf.Tensor, numpy.ndarray, None] = None) -&gt; tf.Tensor</span></code><a class="headerlink" href="#explain" title="Permanent link">&para;</a></h4>
<p>Compute the total Sobol' indices according to the explainer parameter (perturbation
function, grid size...). Accept Tensor, numpy array or tf.data.Dataset (in that case
targets is None).
<br></p>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>inputs</span></strong>            : <span class='parameter-type'>Union[tf.Dataset, tf.Tensor, numpy.ndarray]</span> </p>
<ul>
<li><p> Images to be explained, either tf.dataset, Tensor or numpy array.</p><p> If Dataset, targets should not be provided (included in Dataset).</p><p> Expected shape (N, W, H, C) or (N, W, H).</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>targets</span></strong>            : <span class='parameter-type'>Union[tf.Tensor, numpy.ndarray, None] = None</span> </p>
<ul>
<li><p> One-hot encoding for classification or direction {-1, +1} for regression.</p><p> Tensor or numpy array.</p><p> Expected shape (N, C) or (N).</p> </li>
</ul>
</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>attributions_maps</span></strong>            : <span class='parameter-type'>tf.Tensor</span> </p>
<ul>
<li><p> GSA Attribution Method explanations, same shape as the inputs except for the channels.</p> </li>
</ul>
</li>
</ul>
<p><br></p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p><a href="https://arxiv.org/abs/2206.06219">Making Sense of Dependence: Efficient Black-box Explanations Using Dependence Measure (2022)</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../guided_backpropagation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Guided Backprop" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Guided Backprop
            </div>
          </div>
        </a>
      
      
        
        <a href="../integrated_gradients/" class="md-footer__link md-footer__link--next" aria-label="Next: Integrated Gradient" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Integrated Gradient
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../../assets/javascripts/workers/search.409db549.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.756773cc.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../../js/custom.js"></script>
      
    
  </body>
</html>